<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="j.jave.platform.basicwebcomp.param.mapper.ParamMapper">


<resultMap id="base"  type="j.jave.kernal.jave.model.JBaseModel" >
		<result column="ID" property="id" />
		<result column="CREATEID" property="createId" />
		<result column="UPDATEID" property="updateId" />
		<result column="CREATETIME" property="createTime" />
		<result column="UPDATETIME" property="updateTime" />
		<result column="DELETED" property="deleted" />
		<result column="VERSION" property="version" />
</resultMap>

<resultMap type="j.jave.platform.basicwebcomp.param.model.Param" id="param"  extends="base" >
	<result column="FUNCTIONID" property="functionId" />
	<result column="CODE" property="code" />
	<result column="NAME" property="name" />
	<result column="DESCRIPTION" property="description" />
</resultMap>


<insert  id="saveModel" >
insert into PARAM
(
ID,CREATEID,UPDATEID,CREATETIME,UPDATETIME,DELETED,VERSION
,FUNCTIONID
,CODE
,NAME
,DESCRIPTION
)
 values 
(
#{id}
,#{createId}
,#{updateId}
,#{createTime}
,#{updateTime}
,#{deleted}
,#{version}
,#{functionId}
,#{code}
,#{name}
,#{description}
) 
</insert>

<update id="updateModel">
updateModel PARAM
set UPDATEID=#{updateId}
,UPDATETIME=#{updateTime}
,VERSION=#{version}
,FUNCTIONID=#{functionId}
,CODE=#{code}
,NAME=#{name}
,DESCRIPTION=#{description}
where ID=#{id}
</update>

<select id="getModel"   resultMap="param"  >
select * from PARAM where id=#{param1}
</select>

<delete id="markModelDeleted" >
	updateModel PARAM set DELETED='Y' where ID=#{id}
</delete>

<select id="getParamByFunctionIdAndCode"  resultMap="param"  >
	select * from PARAM where DELETED='N' and FUNCTIONID = #{functionId} and CODE =  #{code}  
</select>

<select id="getParamByFunctionId"  resultMap="param"  >
	select * from PARAM where DELETED='N' and FUNCTIONID = #{functionId} 
</select>

<select id="getParamsByPage"  resultMap="param"  parameterType="j.jave.kernal.jave.model.JBaseModel">
	select * from PARAM where DELETED='N' 
	<if test="functionId!=null and functionId!=''">
		and FUNCTIONID = #{functionId}
	</if>
	<if test="code!=null and code!=''">
		and CODE like CONCAT('%',  #{code} ,'%')
	</if>
	<if test="name!=null and name!=''">
		and NAME like CONCAT('%',#{name},'%')
	</if>
	order by FUNCTIONID desc ,UPDATETIME desc
</select>


<select id="getModelsByPage"  resultMap="param"  parameterType="j.jave.kernal.jave.model.JBaseModel">
    select * from PARAM 
    <if test="page.sortColumn!=null ">
    	order by ${page.sortColumn} ${page.sortType}    
    </if>
</select>

</mapper>