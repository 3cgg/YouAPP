
<link rel="stylesheet" href="cms/contentmanager/content-add.css">

<!-- Main content -->
    <section class="content"  id="addContentSection" >
    	<div class="box box-bys-btn">
	        <div class="box-footer">
	          <button type="button" class="btn btn-primary btn-sm"  id="addContentBtn" >提交</button>
	          <button type="button" class="btn btn-primary btn-sm"
	          onclick='$(this).goView("/pages/cms/contentmanager/content-list.html");'
	          >返回</button>
                <div class="box-tools pull-right">
                    新增
                </div>
	        </div> 
      </div>
    	
    	<div class="box box-bys-content">
	    	<!--   .box-header   -->
	        <!-- /.box-header -->
	        
	        <div class="box-body">
	        
	        <form role="form"  id="addContentForm"  class="form-horizontal">
              	<div class="form-group">
              	
              	   <label for="title" class="col-sm-1 control-label requiredMask">标题</label>
                   <div class="col-sm-11 col-lg-11">
                    <input  id="title" name="title" type="text" class="form-control"></input>
                  </div>
              	  
              	</div>
					
              	<div class="form-group">

					<label for="author" class="col-sm-1 control-label requiredMask">作者</label>
					<div class="col-sm-5">
						<input  id="author" name="author" type="text" class="form-control"></input>
					</div>
					
              	
              	   <label for="source" class="col-sm-1 control-label requiredMask">来源</label>
                   <div class="col-sm-5">
                    <input  id="source" name="source" type="text" class="form-control"></input>
                  </div>
              	  
              	</div>

				<div class="form-group">

					<label for="publishTime" class="col-sm-1 control-label requiredMask">发布时间</label>
					<div class="col-sm-5">

						<input  id="publishTime" name="publishTime" type="text" class="form-control" ></input>

					</div>

					<label for="sequence" class="col-sm-1 control-label requiredMask">顺序</label>
					<div class="col-sm-1 col-lg-1 ">
						<input  id="sequence" name="sequence" type="text" class="form-control"></input>
					</div>

				</div>


					
              	<div class="form-group">

              	   <label for="link" class="col-sm-1 control-label requiredMask">源地址（http://）</label>
                   <div class="col-sm-11 col-lg-11">
                    <input  id="link" name="link" type="text" class="form-control"></input>
                  </div>

              	</div>


				<div class="form-group">

					<label for="overview" class="col-sm-1 control-label requiredMask">简介</label>
					<div class="col-sm-11 col-lg-11">
						<textarea id="overview" name="overview"  class="form-control" rows="3" placeholder=" ..." ></textarea>
					</div>

				</div>

					
              	<div class="form-group">
              	
              	   <label for="adImg" class="col-sm-1 control-label requiredMask">宣传图</label>
                   <div class="col-sm-5">
					   <div name="fileUploadDiv"></div>
					   <input id="adImg" name="adImg" type="text" class="form-control" style="width:0px;height: 0px;padding: 0px;"></input>
                  </div>

                  </div>
				<div class="form-group">

					<label for="content" class="col-sm-1 control-label requiredMask">内容</label>
					<!--<div class="col-sm-5">-->
					<!--<div id="contentContainer" name="contentContainer" class="col-sm-11 col-lg-11" ></div>-->
					<div class="col-sm-11 col-lg-11">
						<textarea id="content" name="content" style="border: solid 1px #887c7c;height: 318px" class="form-control" rows="15" placeholder=" ..." readonly ></textarea>
						<div class="editor-cover" >

							<div style="">
								<a id="contentEdit" href="#" class="btn editor-cover-btn hover-black-opacity" title="" >
									编辑
								</a>
								<a id="contentPreview" href="#" class="btn editor-cover-btn hover-black-opacity " title="" >
									查看
								</a>

							</div>
						</div>
					</div>

				</div>

					
    		</form>
	          <!-- /.row -->
	        </div>
      </div>

		<div id="filesDiv"  style="display:none;">
			<!--
            <form role="form" id="caseImage1FileForm" class="form-horizontal">
              <input type="file"  />
            </form>-->
		</div>

    </section>
	
	
	<script type="text/javascript">
		
		$_youapp.ready(function (){
			
			var page=$.extend({
	    		root:$("#addContentSection"),
	    		model:{
	    		}
	    	},$_youapp.pageTemplate);

			page.root.find('#publishTime').datetimepicker();

			
			page.root.find("#addContentForm").validate({
					rules: {
						'title': {
							   required: true,
							   maxlength:255
						   }
						,
						'author': {
							   required: true,
							   maxlength:64
						   }
						,
						'publishTime': {
							   required: true,
							   maxlength:16
						   }
						,
						'source': {
							   required: true,
							   maxlength:64
						   }
						,
						'link': {
							   required: true,
							   maxlength:255
						   }
						,
						'overview': {
							   required: true,
							   maxlength:2000
						   }
						,
						'adImg': {
							   required: true,
							   maxlength:64
						   }
						,
						'content': {
							   required: true
						   }
						,
						'sequence': {
							   required: true,
							   number : true
						   }
					  },
					  submitHandler:function(form){
						  page.submitForm({
							  url:'/contentmanager/saveContent',
							  formSelector:form,
							  success:function(data){
								  page.root.goView('/pages/cms/contentmanager/content-list.html');
							  }
							});
					 }
				});
			page.root.find('#addContentBtn').on('click',function(){
				page.root.find("#addContentForm").submit();
			});

			page.root.find('#contentEdit').on('click',function () {
			    var $content=page.root.find('#content');
                page.editorModal.open(page,
                    {	id:"contentEditorModal",
                        title:"内容详情",
                        hidden : function(txt){
                            console.log("hide modal  "+ JSON.stringify(txt) );
                            $content.val(txt.htmlContent);
                        },
						opt:{
                            width : '100%',
                            height : '100%'
						}
                    },'/pages/cms/contentmanager/content-editor-pop.html',
					{
					    name : 'contentEditor',
						content : $content.val()
					});
            });

            page.root.find('#contentPreview').on('click',function () {
                var $content=page.root.find('#content');
                page.editorModal.open(page,
                    {	id:"contentPreviewModal",
                        title:"内容详情",
                        hidden : function(txt){
                            console.log("hide modal  "+ JSON.stringify(txt) );
                            $content.val(txt.htmlContent);
                        },
                        opt:{
                            width : '100%',
                            height : '100%'
                        }
                    },'/pages/cms/contentmanager/content-editor-pop.html',
                    {
                        name : 'contentPreview',
                        content : $content.val(),
						preview : true
                    });
            });


//			UE.delEditor('contentContainer');
//
//            var contentContainer = UE.getEditor('contentContainer',{
//
//
//            });
//
//            $('#tabContainer').scroll(function (event) {
//                var $this=$(event.target);
//                var top=$this.scrollTop();
//
//                console.log(top)
//
//
//            });

            page.root.find('[name="fileUploadDiv"]').each(function(i,e){
                var opt={
                    $fsc : $(e),
                    $fc : page.root.find('#filesDiv'), // form container
                    added : function(data,obj){
                        obj.opt.$fsc.parent().children('input').val(data.id);
                    },
                    removed : function(data,obj){
                        obj.opt.$fsc.parent().children('input').val('');
                    },
                    types : ['image/jpeg','image/jpg','image/png']
                }
                fileAttach(opt);
            });



		});
	</script>


